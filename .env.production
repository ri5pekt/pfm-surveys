# ==============================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ==============================================
# Copy this to .env on the VPS server and update all values
# IMPORTANT: Generate new secrets before deploying!

# ----------------------------------------------
# Production Settings
# ----------------------------------------------
NODE_ENV=production
DOMAIN=surveys.pfm-qa.com

# ----------------------------------------------
# Database Configuration (Docker internal)
# ----------------------------------------------
DATABASE_HOST=postgres
DATABASE_PORT=5432
DATABASE_NAME=surveys_prod
DATABASE_USER=surveys_user
# GENERATE: Use a strong password (20+ characters)
DATABASE_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD

# Connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# ----------------------------------------------
# Redis Configuration (Docker internal)
# ----------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ----------------------------------------------
# API Server Configuration
# ----------------------------------------------
API_PORT=3000
API_HOST=0.0.0.0

# CORS Settings - Allow your production domain
CORS_ORIGINS=https://surveys.pfm-qa.com

# Request body limits
BODY_LIMIT=1048576

# API rate limiting (production values)
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=60000

# ----------------------------------------------
# Authentication & Security (CRITICAL!)
# ----------------------------------------------
# Generate JWT secret with: openssl rand -base64 32
JWT_SECRET=GENERATE_NEW_SECRET_HERE

# JWT expiration time - 30 days recommended for production
# Users stay logged in without interruption
JWT_ACCESS_EXPIRES_IN=30d

# HMAC validation settings
HMAC_TIMESTAMP_WINDOW_MS=300000
HMAC_NONCE_TTL_SECONDS=600

# ----------------------------------------------
# Email Configuration (Hostinger SMTP)
# ----------------------------------------------
# Uses surveys@pfm-qa.com mailbox on Hostinger
# SMTP: smtp.hostinger.com, port 465 (SSL)
SMTP_HOST=smtp.hostinger.com
SMTP_PORT=465
SMTP_USER=surveys@pfm-qa.com
SMTP_PASS=your_email_password_here
EMAIL_FROM_NAME=PFM Surveys

# Admin URL for email links (invitation emails, password resets, etc.)
ADMIN_URL=https://surveys.pfm-qa.com

# ----------------------------------------------
# Geo / IP API (Optional but Recommended)
# ----------------------------------------------
# Get your key from: https://ip-api.com/
# Enables country/state/city geolocation for survey responses
IP_API_KEY=your_ip_api_key_here

# ----------------------------------------------
# Background Worker Configuration
# ----------------------------------------------
WORKER_CONCURRENCY=5
ROLLUP_INTERVAL_MS=60000
ROLLUP_BATCH_SIZE=1000

# ----------------------------------------------
# Admin Dashboard (Frontend)
# ----------------------------------------------
# CRITICAL: This is baked into the build at build time!
# Must be set to production domain BEFORE building
VITE_API_BASE_URL=https://surveys.pfm-qa.com

# ----------------------------------------------
# Embed Script Configuration
# ----------------------------------------------
VITE_EMBED_API_URL=https://surveys.pfm-qa.com
VITE_EMBED_VERSION=1.0.0
VITE_EMBED_BUFFER_SIZE=10
VITE_EMBED_FLUSH_INTERVAL_MS=5000

# ----------------------------------------------
# Logging Configuration (Production)
# ----------------------------------------------
LOG_LEVEL=info
LOG_PRETTY_PRINT=false

# ----------------------------------------------
# Security Settings
# ----------------------------------------------
FORCE_HTTPS=true
TRUST_PROXY=true
SESSION_SECURE=true

# ----------------------------------------------
# Rate Limiting (Production - More Restrictive)
# ----------------------------------------------
RATE_LIMIT_GLOBAL_MAX=1000
RATE_LIMIT_IP_MAX=60
RATE_LIMIT_SITE_MAX=200

# ----------------------------------------------
# Docker Compose Settings
# ----------------------------------------------
COMPOSE_PROJECT_NAME=pfm-surveys-prod

# PostgreSQL (for docker-compose)
POSTGRES_USER=surveys_user
POSTGRES_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD
POSTGRES_DB=surveys_prod
